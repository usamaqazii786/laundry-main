const scrollTrackingMode=analytifyScroll.tracking_mode;const isTrackingModeGA4=analytifyScroll.ga4_tracking;(function($){(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory)}else if(typeof module==='object'&&module.exports){module.exports=factory(require('jquery'))}else{factory(jQuery)}}(function($){"use strict";let defaults={percentage:!0};let $window=$(window),cache=[],scrollEventBound=!1,lastPixelDepth=0;$.scrollDepth=function(options){let startTime=+new Date();options=$.extend({},defaults,options);function sendEvent(page_link,percentage,scrollDistance,timing){if('gtag'===scrollTrackingMode){if(isTrackingModeGA4){gtag('event','scroll_depth',{'wpa_category':'Analytify Scroll Depth','wpa_percentage':percentage,'non_interaction':!0})}else{gtag('event',percentage,{'event_category':'Analytify Scroll Depth','event_label':page_link,'value':1,'non_interaction':!0})}
if(arguments.length>3){gtag('event','timing_complete',{'event_category':'Analytify Scroll Depth','event_label':page_link,'value':timing,'non_interaction':!0})}}else{let fieldsArray={hitType:'event',eventCategory:'Analytify Scroll Depth',eventAction:percentage,eventLabel:page_link,eventValue:1,nonInteraction:1};if('function'===typeof ga){ga('send',fieldsArray)}
if(arguments.length>3){fieldsArray={hitType:'timing',timingCategory:'Analytify Scroll Depth',timingVar:percentage,timingValue:timing,timingLabel:page_link,nonInteraction:1};if('function'===typeof ga){ga('send',fieldsArray)}}}}
function calculateMarks(docHeight){return{'25':parseInt(docHeight*0.25,10),'50':parseInt(docHeight*0.50,10),'75':parseInt(docHeight*0.75,10),'100':docHeight-5}}
function checkMarks(marks,scrollDistance,timing){$.each(marks,function(key,val){if($.inArray(key,cache)===-1&&scrollDistance>=val){sendEvent(analytifyScroll.permalink,key,scrollDistance,timing);cache.push(key)}})}
function rounded(scrollDistance){return(Math.floor(scrollDistance/250)*250).toString()}
function init(){bindScrollDepth()}
$.scrollDepth.reset=function(){cache=[];lastPixelDepth=0;$window.off('scroll.scrollDepth');bindScrollDepth()};$.scrollDepth.addElements=function(elems){if(typeof elems=="undefined"||!$.isArray(elems)){return}
$.merge(options.elements,elems);if(!scrollEventBound){bindScrollDepth()}};$.scrollDepth.removeElements=function(elems){if(typeof elems=="undefined"||!$.isArray(elems)){return}
$.each(elems,function(index,elem){let inElementsArray=$.inArray(elem,options.elements);let inCacheArray=$.inArray(elem,cache);if(inElementsArray!=-1){options.elements.splice(inElementsArray,1)}
if(inCacheArray!=-1){cache.splice(inCacheArray,1)}})};function throttle(func,wait){let context,args,result;let timeout=null;let previous=0;let later=function(){previous=new Date;timeout=null;result=func.apply(context,args)};return function(){let now=new Date;if(!previous)previous=now;let remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args)}else if(!timeout){timeout=setTimeout(later,remaining)}
return result}}
function bindScrollDepth(){scrollEventBound=!0;$window.on('scroll.scrollDepth',throttle(function(){let docHeight=$(document).height(),winHeight=window.innerHeight?window.innerHeight:$window.height(),scrollDistance=$window.scrollTop()+winHeight,marks=calculateMarks(docHeight),timing=+new Date-startTime;checkMarks(marks,scrollDistance,timing)},500))}
init()};return $.scrollDepth}));$.scrollDepth()})(jQuery)
import{V as s,a as b,n as i,m as d,i as x}from"./chunks/vendor-b9834729.min.js";import{R as w,D as $}from"./chunks/date-intervals-5a2b6478.min.js";import{W as C}from"./chunks/WidgetReportError-1a54c6a5.min.js";import{M as y,s as r}from"./chunks/index-11e10b96.min.js";const D=e=>new Promise(t=>{let n=new FormData,c=s.prototype.$mi.page_id?s.prototype.$mi.page_id:window.location.pathname;n.append("action","exactmetrics_pageinsights_refresh_report"),n.append("security",s.prototype.$mi.nonce),n.append("report","pageinsights"),n.append("post_id",c),n.append("json",1),b.post(s.prototype.$mi.ajax,n).then(a=>{t(a.data)}).catch(function(a){e.dispatch("$_app/block",!1,{root:!0}),a.response})}),P={fetchReportData:D},R=e=>new Promise(t=>{e.dispatch("$_queue/add",()=>P.fetchReportData(e).then(function(n){if(n.data.message==="license_level"){t(!1);return}n.success?(e.commit("UPDATE_REPORT_DATA",{report:"pageinsights",data:n.data}),t(!0)):(s.prototype.$mi_error_toast(!1,n.data.message,n.data.footer),t(!1))}),{root:!0})}),T={getReportData:R},E=e=>e.date,A=e=>e.pageinsights,S=e=>e.loaded,U=e=>e.error,F=e=>e.noauth,M={date:E,pageinsights:A,loaded:S,error:U,noauth:F},O=(e,t)=>{t.report&&t.data&&e[t.report]&&s.set(e,t.report,t.data)},N=(e,t)=>{t.start&&t.end&&(s.set(e.date,"start",t.start),s.set(e.date,"end",t.end))},I=(e,t)=>{s.set(e.date,"interval",t)},L=(e,t)=>{e.loaded=t},V=(e,t)=>{e.error=t},k=e=>{e.noauth=!0,e.loaded=!0},H={UPDATE_REPORT_DATA:O,UPDATE_DATE:N,UPDATE_INTERVAL:I,UPDATE_LOADED:L,SET_ERROR:V,ENABLE_NOAUTH:k},W={loaded:!1,pageinsights:{},error:!1,noauth:!1},z={namespaced:!0,state:W,actions:T,getters:M,mutations:H},B={name:"FrontendStatsColumn",props:{extraClass:{type:String,default:""},label:String,value:[String,Number]},computed:{columnClass(){return"exactmetrics-stats-column "+this.extraClass}}};var G=function(){var t=this,n=t._self._c;return n("div",{class:t.columnClass},[t.label?n("div",{staticClass:"exactmetrics-stats-label",domProps:{textContent:t._s(t.label)}}):t._e(),t.value?n("div",{staticClass:"exactmetrics-stats-value",domProps:{innerHTML:t._s(t.value)}}):t._e(),t._t("default")],2)},K=[],Y=i(B,G,K,!1,null,null,null,null);const j=Y.exports,{__:_}=wp.i18n,q={name:"FrontendUpsell",data(){return{text_button:_("Upgrade to PRO","google-analytics-dashboard-for-wp"),is_admin:this.$mi.is_admin,text_view_reports:_("View All Reports","google-analytics-dashboard-for-wp")}},computed:{upgradeUrl(){return this.$getUpgradeUrl("frontend-reports","admin-bar")},reportsUrl(){return this.$mi.reports_url},canManageOptions(){return!!(this.$mi.roles_manage_options&&this.$mi.roles_manage_options.length!==0)},buttonText(){return!this.$mi.is_admin&&this.canManageOptions?this.text_button:!this.$mi.is_admin&&!this.canManageOptions?this.text_view_reports:this.text_button},buttonLink(){return!this.$mi.is_admin&&this.canManageOptions?this.upgradeUrl:!this.$mi.is_admin&&!this.canManageOptions?this.reportsUrl:this.upgradeUrl}}};var Z=function(){var t=this,n=t._self._c;return n("a",{staticClass:"exactmetrics-button",attrs:{target:"_blank",rel:"noopener",href:t.buttonLink},domProps:{textContent:t._s(t.buttonText)}})},J=[],Q=i(q,Z,J,!1,null,null,null,null);const X=Q.exports,{__:tt,_n:nt,sprintf:et}=wp.i18n,st={name:"FrontendInfoboxChange",props:{value:String,days:Number,change:Number,color:{default:"green",type:String},direction:{default:"up",type:String}},computed:{compare(){return nt("vs. Previous Day",et("vs. Previous %s Days",this.days),this.days,"google-analytics-dashboard-for-wp")},changeClass(){let e="exactmetrics-reports-infobox-prev";return this.change===0?e:e+" exactmetrics-"+this.color},changeText(){return this.change?this.direction===""?this.change+"%":'<span class="exactmetrics-arrow exactmetrics-'+this.direction+" exactmetrics-"+this.color+'"></span> '+this.change+"%":tt("No change","google-analytics-dashboard-for-wp")}}};var ot=function(){var t=this,n=t._self._c;return n("div",{staticClass:"exactmetrics-frontend-infobox-change"},[n("div",{class:t.changeClass,domProps:{innerHTML:t._s(t.changeText)}}),t.days?n("div",{staticClass:"exactmetrics-reports-infobox-compare",domProps:{textContent:t._s(t.compare)}}):t._e()])},it=[],at=i(st,ot,it,!1,null,null,null,null);const rt=at.exports,{__:lt}=wp.i18n,ct={name:"NotificationsIndicator",data(){return{text_view_notifications:lt("View notifications","google-analytics-dashboard-for-wp")}},computed:{...d({notifications:"$_notifications/notifications",view_url:"$_notifications/view_url",sidebar_url:"$_notifications/sidebar_url"}),has_notifications(){return this.notifications&&this.notifications.length>0}}};var dt=function(){var t=this,n=t._self._c;return n("div",{staticClass:"exactmetrics-notifications-indicator"},[n("a",{attrs:{href:t.sidebar_url,title:t.text_view_notifications}},[n("svg",{attrs:{width:"35",height:"39",viewBox:"0 0 35 39",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M17.6898 39C20.3431 39 22.4954 36.8177 22.4954 34.125H12.8841C12.8841 36.8177 15.0364 39 17.6898 39ZM33.8706 27.5963C32.4192 26.015 29.7035 23.6361 29.7035 15.8438C29.7035 9.9252 25.6108 5.18731 20.0922 4.02492V2.4375C20.0922 1.09154 19.0164 0 17.6898 0C16.3631 0 15.2873 1.09154 15.2873 2.4375V4.02492C9.76874 5.18731 5.67602 9.9252 5.67602 15.8438C5.67602 23.6361 2.96031 26.015 1.50893 27.5963C1.05818 28.0876 0.858356 28.6749 0.862112 29.25C0.870376 30.4992 1.83721 31.6875 3.27357 31.6875H32.1059C33.5423 31.6875 34.5099 30.4992 34.5174 29.25C34.5212 28.6749 34.3213 28.0869 33.8706 27.5963Z",fill:"#393F4C"}})]),t.has_notifications?n("span",{staticClass:"exactmetrics-notifications-unread",domProps:{textContent:t._s(t.notifications.length)}}):t._e()])])},_t=[],ft=i(ct,dt,_t,!1,null,null,null,null);const ut=ft.exports,{__:o}=wp.i18n,ht={name:"FrontendStatsGeneral",components:{NotificationsIndicator:ut,FrontendInfoboxChange:rt,FrontendUpsell:X,FrontendStatsColumn:j},data(){return{text_insights_for:o("Last 30 Days Analytics for ","google-analytics-dashboard-for-wp"),text_your_website:o("Your Website","google-analytics-dashboard-for-wp"),text_sessions:o("Sessions","google-analytics-dashboard-for-wp"),text_pageviews:o("Pageviews","google-analytics-dashboard-for-wp"),text_session_duration:o("Avg. Duration","google-analytics-dashboard-for-wp"),text_total_users:o("Total Users","google-analytics-dashboard-for-wp")}},computed:{...d({overview:"$_reports/overview"}),text_upsell_title(){return this.$mi.is_admin?o("More data is available","google-analytics-dashboard-for-wp"):o("Want to see page-specific stats?","google-analytics-dashboard-for-wp")},infoboxRange(){return this.overview.infobox&&this.overview.infobox.range?this.overview.infobox.range:0},infoboxSessionsData(){return this.infoboxData("sessions")},infoboxPageviewsData(){return this.infoboxData("pageviews")},infoboxDurationData(){return this.infoboxData("duration")},hasTotalUsersData(){return typeof this.infoboxTotalUsersData.value<"u"},infoboxTotalUsersData(){return this.infoboxData("totalusers")}},methods:{infoboxData(e,t=!1){let n={};return this.overview.infobox&&this.overview.infobox[e]&&(n.change=this.overview.infobox[e].prev,n.value=this.overview.infobox[e].value.toString(),this.overview.infobox[e].prev===0?n.direction="":this.overview.infobox[e].prev>0?(n.direction="up",n.color="green"):(n.direction="down",n.color="red")),t&&(n.direction==="down"?n.color="green":n.color="red"),n}},mounted(){if(!this.$mi.authed){this.$store.commit("$_frontend/ENABLE_NOAUTH");return}this.$store.dispatch("$_reports/getReportData","overview").then(()=>{this.$store.commit("$_frontend/UPDATE_LOADED",!0)})}};var pt=function(){var t=this,n=t._self._c;return t.overview.infobox?n("div",{staticClass:"exactmetrics-frontend-stats-inner"},[n("h3",[n("span",{domProps:{textContent:t._s(t.text_insights_for)}}),n("span",{domProps:{textContent:t._s(t.text_your_website)}})]),n("div",{staticClass:"exactmetrics-frontend-stats-grey-area"},[n("frontend-stats-column",{attrs:{label:t.text_sessions,value:t.overview.infobox.sessions.value}},[n("frontend-infobox-change",{attrs:{change:t.infoboxSessionsData.change,color:t.infoboxSessionsData.color,direction:t.infoboxSessionsData.direction,days:t.infoboxRange}})],1),n("frontend-stats-column",{attrs:{label:t.text_pageviews,value:t.overview.infobox.pageviews.value}},[n("frontend-infobox-change",{attrs:{change:t.infoboxPageviewsData.change,color:t.infoboxPageviewsData.color,direction:t.infoboxPageviewsData.direction,days:t.infoboxRange}})],1),n("frontend-stats-column",{attrs:{label:t.text_session_duration,value:t.overview.infobox.duration.value}},[n("frontend-infobox-change",{attrs:{change:t.infoboxDurationData.change,color:t.infoboxDurationData.color,direction:t.infoboxDurationData.direction,days:t.infoboxRange}})],1),t.hasTotalUsersData?n("frontend-stats-column",{attrs:{label:t.text_total_users,value:t.infoboxTotalUsersData.value}},[n("frontend-infobox-change",{attrs:{change:t.infoboxTotalUsersData.change,color:t.infoboxTotalUsersData.color,direction:t.infoboxTotalUsersData.direction,days:t.infoboxRange}})],1):t._e(),n("frontend-stats-column",{staticClass:"exactmetrics-frontend-column-button"},[n("frontend-upsell")],1),n("frontend-stats-column",{staticClass:"exactmetrics-frontend-column-notifications"},[n("notifications-indicator")],1)],1)]):t._e()},gt=[],mt=i(ht,pt,gt,!1,null,null,null,null);const vt=mt.exports,bt={name:"FrontendStatsContent",components:{FrontendStatsGeneral:vt}};var xt=function(){var t=this,n=t._self._c;return n("div",{staticClass:"exactmetrics-content-lite"},[n("frontend-stats-general")],1)},wt=[],$t=i(bt,xt,wt,!1,null,null,null,null);const Ct=$t.exports,{__:l}=wp.i18n,yt={name:"FrontendNoAuth",data(){return{text_no_auth:l("Please Setup Website Analytics to See Audience Insights","google-analytics-dashboard-for-wp"),text_auth_label:l("ExactMetrics, the #1 WordPress Analytics Plugin, helps you connect your website with Google Analytics, so you can see how people find and use your website. Over 3 million website owners use ExactMetrics to see the stats that matter and grow their business.","google-analytics-dashboard-for-wp"),text_wizard:l("Connect ExactMetrics and Setup Website Analytics","google-analytics-dashboard-for-wp"),text_learn:l("Learn More","google-analytics-dashboard-for-wp"),wizard_url:this.$mi.wizard_url,learn_link:this.$mi.getting_started_url}}};var Dt=function(){var t=this,n=t._self._c;return n("div",{staticClass:"exactmetrics-not-authenticated-notice"},[n("h3",{domProps:{textContent:t._s(t.text_no_auth)}}),n("div",{staticClass:"exactmetrics-settings-input exactmetrics-settings-input-authenticate"},[n("p",{domProps:{textContent:t._s(t.text_auth_label)}}),n("div",[n("a",{staticClass:"exactmetrics-wp-button exactmetrics-wp-button-primary",attrs:{href:t.wizard_url},domProps:{textContent:t._s(t.text_wizard)}}),n("a",{staticClass:"exactmetrics-wp-button",attrs:{href:t.learn_link},domProps:{textContent:t._s(t.text_learn)}})])])])},Pt=[],Rt=i(yt,Dt,Pt,!1,null,null,null,null);const Tt=Rt.exports,Et={name:"ModuleFrontendReports",components:{FrontendNoAuth:Tt,WidgetReportError:C,FrontendStatsContent:Ct},data(){return{text_insights:"ExactMetrics",statsVisible:!1,page_id:this.$mi.page_id}},created(){const e="$_reports";e in this.$store._modules.root._children||this.$store.registerModule(e,w);const t="$_frontend";t in this.$store._modules.root._children||this.$store.registerModule(t,z)},computed:{...d({reportdata:"$_frontend/pageinsights",loaded:"$_frontend/loaded",error:"$_frontend/error",noauth:"$_frontend/noauth",notifications:"$_notifications/notifications"}),toggleButtonClass(){let e="ab-item ab-empty-item exactmetrics-toggle";return this.statsVisible&&(e+=" exactmetrics-toggle-active"),e},has_notifications(){return this.notifications&&this.notifications.length>0}},methods:{toggleStatsVisibility(){this.statsVisible=!this.statsVisible}}};var At=function(){var t=this,n=t._self._c;return n("li",{staticClass:"exactmetrics-adminbar-menu-item",attrs:{id:"wp-admin-bar-exactmetrics_frontend_button"}},[n("div",{class:t.toggleButtonClass,on:{click:t.toggleStatsVisibility}},[n("span",{staticClass:"ab-icon dashicons-before dashicons-chart-bar"}),n("span",{staticClass:"exactmetrics-admin-bar-handle-text",domProps:{textContent:t._s(t.text_insights)}}),t.has_notifications?n("span",{staticClass:"exactmetrics-menu-notification-indicator",domProps:{textContent:t._s(t.notifications.length)}}):t._e()]),t.statsVisible?n("div",{staticClass:"exactmetrics-frontend-stats"},[t.noauth?n("frontend-no-auth"):t.error?n("widget-report-error",{attrs:{error:t.error}}):n("frontend-stats-content"),t.loaded?t._e():n("div",{staticClass:"exactmetrics-frontend-stats-loading"},[t._m(0)])],1):t._e()])},St=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"exactmetrics-roller"},[t("div"),t("div"),t("div"),t("div"),t("div"),t("div"),t("div")])}],Ut=i(Et,At,St,!1,null,null,null,null);const Ft=Ut.exports;const{__:f}=wp.i18n,Mt={install(e,{store:t}){e.prototype.$mi_loading_toast||(e.prototype.$mi_loading_toast=function(){}),e.prototype.$mi_error_toast||(e.prototype.$mi_error_toast=function(n){let{type:c="error",customContainerClass:a="exactmetrics-swal",allowOutsideClick:u=!1,allowEscapeKey:h=!1,allowEnterKey:p=!1,title:g=f("Error","google-analytics-dashboard-for-wp"),html:m=f("Please try again.","google-analytics-dashboard-for-wp"),footer:v=!1}=n;n={type:c,customContainerClass:a,allowOutsideClick:u,allowEscapeKey:h,allowEnterKey:p,title:g,html:m,footer:v},t.commit("$_frontend/SET_ERROR",{title:n.title,content:n.html,footer:n.footer})}),e.prototype.$mi_intervals=function(){return $}}};window.addEventListener("load",function(){const e=document.getElementById("wp-admin-bar-exactmetrics_frontend_button");s.config.productionTip=!1,e&&({}.NODE_ENV!=="production"&&(s.config.devtools=!0,s.config.performance=!0),x({ctrl:!0}),s.use(y),s.use(Mt,{store:r}),new s({store:r,mounted:()=>{window.pagenow&&window.pagenow!=="dashboard"&&window.pagenow!=="toplevel_page_exactmetrics_reports"&&r.dispatch("$_queue/add",()=>r.dispatch("$_notifications/getNotifications"))},render:t=>t(Ft)}).$mount(e))});
